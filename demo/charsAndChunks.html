<!DOCTYPE html>
<html>
  <head>
    <link type="text/css" href="../dist/charsAndChunks.css" rel="stylesheet" />
    <link type="text/css" href="./demo.css" rel="stylesheet" />

    <script src="../dist/charsAndChunks.js"></script>
  </head>
  <body>
    <header>
      <button
        onclick="document.body.removeChild(document.querySelector('header'))"
      >remove header</button>
      <h1>Demo of keystroking and barcode scanning</h1>
      <p>The header is the context for the 'h' hotkey or any barcode</p>
    </header>

    <main>
      <button
        onclick="document.querySelector('body > main').remove()"
      >remove main element</button>
      <button accesskey="o"
        onclick="charsAndChunks.help()"
      >show overview</button>
      <p>The main element is the context for the 'm' hotkey and a all-digit barcode</p>
      <p>There is an accesskey set on the "show overview" button</p>
      <p>Navigate the buttons with ArrowLeft or ArrowRight</p>
      <input placeholder="try the input" type="text "/>
      <p>Focus the input with Ctrl+i keycombination</p>
      <p>Blur any element with Backspace</p>

    </main>

    <customfooter>
      <button
        onclick="document.body.removeChild(document.querySelector('customfooter'))"
      >remove custom footer</button>
      <p>The custom footer is the context for the 'f' hotkey and a underscore seprated barcode</p>
    </customfooter>

    <script>
    let header = document.querySelector('header')
    let customfooter = document.querySelector('customfooter')

    let logH = function () {console.log('h pressed')}
    charsAndChunks.hotkey ({ char: 'h', context: header, callback: logH })

    let logM = () => {console.log('m pressed')}
    charsAndChunks.hotkey ({ char: 'm', context: 'main', callback: logM, comment: 'Prints "m pressed" in the console' })

    function logF () {console.log('f pressed')}
    charsAndChunks.hotkey ({ char: 'f', context: customfooter, callback: logF })

    function logAltCtrlO () {console.log('ø pressed')}
    charsAndChunks.hotkey ({ char: 'ø', context: 'main', callback: logAltCtrlO, comment: 'same as accesskey "o" in chrome|ff/mac and ie|edge' })
    function logAltShiftO () {console.log('Ø pressed')}
    charsAndChunks.hotkey ({ char: 'Ø', context: 'main', callback: logAltShiftO, comment: 'same as accesskey "o" in chrome|ff/win' })

    let logAnyBarcode = function () {console.log('any barcode scanned')}
    charsAndChunks.barcode ({ context: header, callback: logAnyBarcode })

    logAllDigitBarcode = () => {console.log('all-digit barcode scanned')}
    charsAndChunks.barcode ({ regex: /^\d+$/, context: 'main', callback: logAllDigitBarcode, comment: 'Prints "all-digit barcode scanned" in the console' })

    function logHyphenSeperatedBarcode () {console.log('hyphen seperated barcode scanned')}
    charsAndChunks.barcode ({ regex: /^\w+-\w+$/, context: customfooter, callback: logHyphenSeperatedBarcode })

    function focusPrevButton () {
      const buttons = document.getElementsByTagName('button')
      let prev = buttons.length - 1
      for (let index = 0; index < buttons.length; index++) {
        if (buttons[index] === document.activeElement) {
          prev = index - 1
        }
      }
      if (prev < 0) prev = buttons.length - 1
      buttons[prev].focus()
    }
    charsAndChunks.hotkey ({ char: 'ArrowLeft', context: 'body', callback: focusPrevButton, comment: 'Focus on previous button'})

    function focusNextButton () {
      const buttons = document.querySelectorAll('button')
      const focussed = document.querySelector('*:focus')
      let next = 0
      for (let index = 0; index < buttons.length; index++) {
        if (buttons[index] === focussed) {
          next = index + 1
        }
      }
      if (next >= buttons.length) next = 0
      buttons[next].focus()
    }
    charsAndChunks.hotkey ({ char: 'ArrowRight', context: 'body', callback: focusNextButton, comment: 'Focus on next button'})

    function focusTheBody () {
      window.focus()
      if (document.activeElement) {
          document.activeElement.blur()
      }
    }
    charsAndChunks.hotkey ({ char: 'Backspace', context: 'body', callback: focusTheBody, comment: 'Focus on the body'})

    function focusTheInput () {
      document.querySelector('input').focus()
    }
    charsAndChunks.hotkey ({ char: 'ctrl+i', context: 'main', callback: focusTheInput, comment: 'Focus on the input'})

    </script>
  </body>
</html>
