const e=function(){const e=function(){this.lock=new Map,this.box=new WeakMap};let t=new e,o=[];const n=function(){return!0},r=function(e,o=n){if(t.lock.has(e.entry)){let n=t.lock.get(e.entry);if(n&&t.box.has(n)){if(o(n))return t.box.get(n)[e.entry];t.lock.set(e.entry,void 0),t.box.delete(n)}}},c=function(){t=new e};return{store:function(e){(function(e){const t="object"==typeof e.context;return t||console.error("Cannot store"),t})(e)&&(t.lock.set(e.entry,e.context),t.box.has(e.context)||t.box.set(e.context,{}),t.box.get(e.context)[e.entry]=e.box)},retrieve:r,keys:function(){return t.lock.keys()},overview:function(e=n){let o=[];const c=t.lock.keys();for(let n of c){let c=r({entry:n},e);if(t.lock.get(n)){let e={entry:n,box:c};o.push(e)}}return o},reset:c,overlay:function(){o.push(Object.assign({},t)),c()},revive:function(){o.length&&(t=o.pop())}}}(),t=function(){const t=/^/,o=function(e){const t=e.char?"string"==typeof e.char:e.regex?e.regex instanceof RegExp:void 0,o=("string"==typeof e.context&&(e.context=document.querySelector(e.context)),e.context instanceof Node),n="function"==typeof e.callback;e.comment&&"string"==typeof e.comment||(e.comment=`callback for ${e.char||"barcode"}`);const r=t&&o&&n;return r||(console.error("Wrong properties for registering hotkeys or barcodes!"),location.port&&console.log(e)),r},n=function(t){t.entry=t.char||t.regex,t.box={callback:t.callback,comment:t.comment},e.store(t)},r=function(e){return e&&(e.getRootNode()instanceof Document||e.getRootNode()instanceof ShadowRoot)};return{registerHotkey:function(e){delete e.regex,o(e)&&n(e)},hotkeyHandler:function(t){return e.retrieve({entry:t},r)},registerBarcode:function(e){delete e.char,e.regex||(e.regex=t),o(e)&&n(e)},barcodeHandler:function(o){const n=function(o){let n=t;const r=e.keys();for(let e of r)e instanceof RegExp&&e.test(o)&&e.toString().length>n.toString().length&&(n=e);return n}(o);return e.retrieve({entry:n},r)},overview:function(){return function(e){let t={};return e.forEach(e=>{if(e.box&&"string"==typeof e.entry){let o={entry:e.entry,comment:e.box.comment};t.hotkey=t.hotkey?t.hotkey.concat([o]):[o]}if(e.box&&e.entry instanceof RegExp){let o={entry:"barcode",comment:e.box.comment};t.barcode=t.barcode?t.barcode.concat([o]):[o]}}),t}(e.overview(r))},reset:e.reset,overlay:e.overlay,revive:e.revive}}(),o=function(){const e=["Shift"];let o=0,n=[];const r=function(e){let o=n.join("");if(n.length>=6){let e=t.barcodeHandler(o);e&&e.callback(o)}else if(1===n.length){e.ctrlKey&&(o=`ctrl+${o}`);let n=t.hotkeyHandler(o);n&&n.callback(o)}n=[]};return window.addEventListener("keydown",(function(t){if(o&&clearTimeout(o),"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&"SELECT"!==t.target.tagName){if(t.key.length>1){if("Enter"===t.key)return void r(t);if(!e.includes(t.key))return n=[t.key],void r(t)}else n.push(t.key);o=setTimeout(r,30,t)}else n=[]})),{publicAPI:{hotkey:t.registerHotkey,barcode:t.registerBarcode,overview:t.overview,reset:t.reset,overlay:t.overlay,revive:t.revive},testAPI:{hotkeyHandler:t.hotkeyHandler,barcodeHandler:t.barcodeHandler}}}().publicAPI;export default o;
//# sourceMappingURL=charsAndChunks.js.map
